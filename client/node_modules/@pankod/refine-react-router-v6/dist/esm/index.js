import{handleUseParams as T}from"@pankod/refine-core";import{useLocation as B,useParams as V,Link as Y,useNavigate as Z}from"react-router-dom";import h from"react";import{BrowserRouter as j,MemoryRouter as z,HashRouter as O}from"react-router-dom";import e from"react";import{Route as s,Routes as E,Navigate as x,Outlet as X}from"react-router-dom";import{LoginPage as F,ErrorComponent as m,LayoutWrapper as M,useAuthenticated as N,useResource as L,useRefineContext as S,useRouterContext as b,CanAccess as w}from"@pankod/refine-core";var k=({route:r})=>{let{catchAll:o}=S(),{useParams:i}=b(),{resources:P}=L(),{action:l,id:u}=i(),d=P.find(f=>f.route===r);if(d){let{list:f,create:y,edit:g,show:c,name:a,canCreate:C,canEdit:R,canShow:n,canDelete:t,options:p}=d,H=f!=null?f:()=>null,I=y!=null?y:()=>null,D=g!=null?g:()=>null,J=c!=null?c:()=>null;return(()=>{switch(l){case void 0:return e.createElement(w,{resource:a,action:"list",fallback:o!=null?o:e.createElement(m,null),params:{resource:d}},f?e.createElement(H,{name:a,canCreate:C,canEdit:R,canDelete:t,canShow:n,options:p}):o!=null?o:e.createElement(m,null));case"create":case"clone":return e.createElement(w,{resource:a,action:"create",fallback:o!=null?o:e.createElement(m,null),params:{id:u?decodeURIComponent(u):void 0,resource:d}},y?e.createElement(I,{name:a,canCreate:C,canEdit:R,canDelete:t,canShow:n,options:p}):o!=null?o:e.createElement(m,null));case"edit":return e.createElement(w,{resource:a,action:"edit",params:{id:u?decodeURIComponent(u):void 0,resource:d},fallback:o!=null?o:e.createElement(m,null)},g?e.createElement(D,{name:a,canCreate:C,canEdit:R,canDelete:t,canShow:n,options:p}):o!=null?o:e.createElement(m,null));case"show":return e.createElement(w,{resource:a,action:"show",params:{id:u?decodeURIComponent(u):void 0,resource:d},fallback:o!=null?o:e.createElement(m,null)},c?e.createElement(J,{name:a,canCreate:C,canEdit:R,canDelete:t,canShow:n,options:p}):o!=null?o:e.createElement(m,null));default:return e.createElement(e.Fragment,null,o!=null?o:e.createElement(m,null))}})()}return e.createElement(e.Fragment,null,o!=null?o:e.createElement(m,null))},v=({initialRoute:r})=>{let{resources:o}=L(),{catchAll:i,DashboardPage:P,LoginPage:l}=S(),{routes:u}=b(),{isFetching:d,isError:f}=N({type:"routeProvider"});if(d)return e.createElement(E,null,e.createElement(s,{path:"*",element:null}));let y=!f,g=()=>{let{pathname:n,search:t}=location,p=`${n}${t}`;return e.createElement(x,{to:`/login?to=${encodeURIComponent(p)}`})},c=[];o.map(n=>{let t=e.createElement(s,{key:`${n.route}`,path:`${n.route}`,element:e.createElement(k,{route:n.route})},e.createElement(s,{path:":action",element:e.createElement(k,{route:n.route})},e.createElement(s,{path:":id",element:e.createElement(k,{route:n.route})})));c.push(t)});let a=()=>{var n;return e.createElement(E,null,[...u||[]].filter(t=>!t.layout).map((t,p)=>e.createElement(s,{key:`custom-route-${p}`,...t,element:t.element})),e.createElement(s,{path:"/",element:e.createElement(M,null,e.createElement(X,null))},[...u||[]].filter(t=>t.layout).map((t,p)=>e.createElement(s,{key:`custom-route-${p}`,...t,element:t.element})),e.createElement(s,{index:!0,element:P?e.createElement(w,{resource:"dashboard",action:"list",fallback:i!=null?i:e.createElement(m,null)},e.createElement(P,null)):e.createElement(x,{to:r!=null?r:`/${(n=o.find(t=>t.list))==null?void 0:n.route}`})}),...[...c||[]],e.createElement(s,{path:"*",element:e.createElement(k,{route:""})})))},C=()=>l?e.createElement(l,null):e.createElement(F,null);return y?a():(()=>e.createElement(E,null,[...u||[]].map((n,t)=>e.createElement(s,{key:`custom-route-${t}`,...n})),e.createElement(s,{path:"/",element:C()}),e.createElement(s,{path:"/login",element:C()}),e.createElement(s,{path:"*",element:e.createElement(g,null)})))()};function U({children:r,...o}){return h.createElement(j,{...o},h.createElement(v,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),r)}function K({children:r,...o}){return h.createElement(z,{...o},h.createElement(v,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),r)}function _({children:r,...o}){return h.createElement(O,{...o},h.createElement(v,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),r)}import{useEffect as q,useContext as G}from"react";import{UNSAFE_NavigationContext as Q}from"react-router-dom";var $=({message:r,when:o,setWarnWhen:i})=>{let P=G(Q).navigator;return q(()=>{if(!o)return;let l=P.block(u=>{window.confirm(r)?(i==null||i(!1),l(),u.retry()):P.location.pathname=window.location.pathname});return l},[o,location,r]),null};export*from"react-router-dom";var W={useHistory:()=>{let r=Z();return{push:r,replace:o=>{r(o,{replace:!0})},goBack:()=>{r(-1)}}},useLocation:B,useParams:()=>{let r=V(),{pathname:o}=B(),i=`/${Object.values(r).join("/")}`;return T({...r,resource:Object.keys(r).length===0?o.substring(1):decodeURIComponent(o.substring(1)).replace(i,"")})},Prompt:$,Link:Y,RouterComponent:U},ke=W;export{U as BrowserRouterComponent,_ as HashRouterComponent,K as MemoryRouterComponent,ke as default};
//# sourceMappingURL=index.js.map